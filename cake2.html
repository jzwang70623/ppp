<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>血型與蛋糕偏好調查問卷 (按鈕式選項)</title>
    <style>
        /* CSS 樣式開始 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f7f8fc;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 40px auto;
            background: #fff;
            padding: 25px 40px;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 15px;
            font-size: 2em;
        }

        h2.survey-description {
            font-size: 1.1em;
            font-weight: normal;
            color: #555;
            margin-bottom: 35px;
            text-align: center;
        }

        .question-block {
            background-color: #fff; /* 原本是 #f9f9f9，改為白色與container一致，靠邊框區分 */
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            /* border-left: 5px solid #3498db; */ /* 取消左邊粗線條，整體更簡潔 */
        }

        .question-block h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #34495e;
            font-size: 1.3em;
        }

        .options-container {
            display: flex;
            flex-wrap: wrap; /* 允許選項換行 */
            gap: 10px; /* 選項之間的間隔 */
        }

        .question-block input[type="radio"] {
            /* 隱藏原始的 radio button */
            opacity: 0;
            position: absolute;
            width: 1px;
            height: 1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
        }

        .question-block label {
            display: inline-block;
            padding: 12px 18px;
            margin: 0; /* gap 已經處理間距 */
            background-color: #f0f0f0;
            border: 2px solid #dcdcdc;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, color 0.2s ease-in-out, transform 0.1s ease;
            font-size: 0.95em;
            text-align: center;
            flex-grow: 1; /* 讓按鈕在空間允許時盡量填充 */
            min-width: 120px; /* 按鈕最小寬度，避免文字過多時太窄 */
        }

        .question-block label:hover {
            background-color: #e0e0e0;
            border-color: #c0c0c0;
        }

        .question-block input[type="radio"]:checked + label {
            background-color: #3498db; /* 選中時的背景色 */
            color: white;
            border-color: #2980b9; /* 選中時的邊框色 */
            font-weight: 500;
        }

        .question-block input[type="radio"]:focus + label {
            /* 增加焦點樣式，提高可訪問性 */
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.4);
        }
        
        .question-block label:active {
            transform: translateY(1px); /* 按下時的微小位移效果 */
        }

        button[type="submit"] {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #2ecc71; /* 提交按鈕顏色 */
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.2em;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            margin-top: 20px; /* 與最後一個問題塊的間距 */
        }

        button[type="submit"]:hover {
            background-color: #27ae60;
        }

        .error-message {
            color: #e74c3c; /* 錯誤訊息顏色 */
            font-size: 0.9em;
            margin-top: 8px;
            display: block; /* 讓錯誤訊息獨占一行 */
            font-weight: 500;
        }
        /* 將錯誤訊息直接放在問題標題後方，如果需要 */
        .question-block h3 .error-message {
            display: inline;
            margin-left: 8px;
            font-size: 0.8em;
        }


        #results {
            margin-top: 40px;
            padding: 25px;
            background-color: #e8f6f3;
            border: 1px solid #a2d9ce;
            border-radius: 8px;
        }
        #results h3 {
            color: #1abc9c;
            margin-top: 0;
        }
        #results pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: #fdfefe;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
            font-size: 0.9em;
            line-height: 1.5;
        }
        /* CSS 樣式結束 */
    </style>
</head>
<body>
    <div class="container">
        <h1>血型與蛋糕偏好調查問卷</h1>
        <h2 class="survey-description">這是一份有趣的問卷，旨在探索血型與蛋糕口味偏好之間可能存在的有趣關聯。感謝您的參與！</h2>

        <form id="mG61Hd"
          action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSdRELNnEfp32ifqRer6gMPVYIKPMxGq0BKBe2.J_Y7u4Wkd3xw/formResponse" method="POST">  
            <!-- 問題1：您的血型是？ -->
            <div class="question-block">
                <h3>問題1：您的血型是？<span class="error-message" id="q1_error"></span></h3>
                <div class="options-container">
                    <input type="radio" name="entry.1871021697_sentinel" value="B型" id="q1_b"><label for="q1_b">B型</label>
                    <input type="radio" name="entry.1871021697_sentinel" value="A型" id="q1_a" required><label for="q1_a">A型</label>
                    <input type="radio" name="entry.1871021697_sentinel" value="O型" id="q1_o"><label for="q1_o">O型</label>
                    <input type="radio" name="entry.1871021697_sentinel" value="AB型" id="q1_ab"><label for="q1_ab">AB型</label>
                    <input type="radio" name="entry.1871021697_sentinel" value="不確定" id="q1_unknown"><label for="q1_unknown">不確定</label>
                </div>
            </div>

            <!-- 問題2：當您選擇蛋糕時，最看重以下哪個因素？ -->
            <div class="question-block">
                <h3>問題2：當您選擇蛋糕時，最看重以下哪個因素？<span class="error-message" id="q2_error"></span></h3>
                <div class="options-container">
                    <input type="radio" name="entry.1834058077_sentinel" value="口味" id="q2_taste" required><label for="q2_taste">口味</label>
                    <input type="radio" name="entry.1834058077_sentinel" value="外觀" id="q2_appearance"><label for="q2_appearance">外觀</label>
                    <input type="radio" name="entry.1834058077_sentinel" value="健康程度" id="q2_health"><label for="q2_health">健康程度</label>
                    <input type="radio" name="entry.1834058077_sentinel" value="品牌/店家" id="q2_brand"><label for="q2_brand">品牌/店家</label>
                    <input type="radio" name="entry.1834058077_sentinel" value="價格" id="q2_price"><label for="q2_price">價格</label>
                </div>
            </div>

            <!-- 問題3：您更偏好哪種類型的蛋糕？ -->
            <div class="question-block">
                <h3>問題3：您更偏好哪種類型的蛋糕？<span class="error-message" id="q3_error"></span></h3>
                <div class="options-container">
                    <input type="radio" name="entry.1333874564_sentinel" value="傳統經典口味" id="q3_classic" required><label for="q3_classic">傳統經典口味<small>（如巧克力、香草、草莓等）</small></label>
                    <input type="radio" name="entry.1333874564_sentinel" value="創新獨特口味" id="q3_innovative"><label for="q3_innovative">創新獨特口味<small>（如抹茶紅豆、焦糖海鹽、薰衣草等）</small></label>
                    <input type="radio" name="entry.1333874564_sentinel" value="顛覆傳統的實驗性口味" id="q3_experimental"><label for="q3_experimental">顛覆傳統的實驗性口味<small>（如香辣巧克力、黑胡椒起司、醬油焦糖等）</small></label>
                    <input type="radio" name="entry.1333874564_sentinel" value="無糖/低糖健康替代品" id="q3_healthy_alt"><label for="q3_healthy_alt">無糖/低糖健康替代品</label>
                    <input type="radio" name="entry.1333874564_sentinel" value="沒有特別偏好" id="q3_no_preference"><label for="q3_no_preference">沒有特別偏好</label>
                </div>
            </div>

            <!-- 問題4：面對一個從未嘗試過的創新蛋糕口味，您的第一反應是？ -->
            <div class="question-block">
                <h3>問題4：面對一個從未嘗試過的創新蛋糕口味，您的第一反應是？<span class="error-message" id="q4_error"></span></h3>
                <div class="options-container">
                    <input type="radio" name="entry.1590523751_sentinel" value="非常期待，立即想嘗試" id="q4_eager" required><label for="q4_eager">非常期待，立即想嘗試</label>
                    <input type="radio" name="entry.1590523751_sentinel" value="有些好奇，但需要了解更多再決定" id="q4_curious"><label for="q4_curious">有些好奇，但需要了解更多再決定</label>
                    <input type="radio" name="entry.1590523751_sentinel" value="保持謹慎，通常等別人嘗試後才會考慮" id="q4_cautious"><label for="q4_cautious">保持謹慎，通常等別人嘗試後才會考慮</label>
                    <input type="radio" name="entry.1590523751_sentinel" value="傾向於避免，更喜歡熟悉的選擇" id="q4_avoid"><label for="q4_avoid">傾向於避免，更喜歡熟悉的選擇</label>
                    <input type="radio" name="entry.1590523751_sentinel" value="視具體口味而定" id="q4_depends"><label for="q4_depends">視具體口味而定</label>
                </div>
            </div>

            <!-- 問題5：在下列創新蛋糕口味中，您最想嘗試哪一種？ -->
            <div class="question-block">
                <h3>問題5：在下列創新蛋糕口味中，您最想嘗試哪一種？<span class="error-message" id="q5_error"></span></h3>
                <div class="options-container">
                    <input type="radio" name="entry.648928768_sentinel" value="抹茶紅酒巧克力" id="q5_matcha_wine" required><label for="q5_matcha_wine">抹茶紅酒巧克力</label>
                    <input type="radio" name="entry.648928768_sentinel" value="焦糖海鹽芝麻" id="q5_caramel_sesame"><label for="q5_caramel_sesame">焦糖海鹽芝麻</label>
                    <input type="radio" name="entry.648928768_sentinel" value="蜂蜜薰衣草檸檬" id="q5_honey_lavender"><label for="q5_honey_lavender">蜂蜜薰衣草檸檬</label>
                    <input type="radio" name="entry.648928768_sentinel" value="辣椒芒果巧克力" id="q5_chili_mango"><label for="q5_chili_mango">辣椒芒果巧克力</label>
                    <input type="radio" name="entry.648928768_sentinel" value="黑芝麻玫瑰" id="q5_sesame_rose"><label for="q5_sesame_rose">黑芝麻玫瑰</label>
                    <input type="radio" name="entry.648928768_sentinel" value="以上都不想嘗試" id="q5_none"><label for="q5_none">以上都不想嘗試</label>
                </div>
            </div>

            <!-- 問題6：您通常在什麼場合會選擇嘗試創新或顛覆傳統的蛋糕口味？ -->
            <div class="question-block">
                <h3>問題6：您通常在什麼場合會選擇嘗試創新或顛覆傳統的蛋糕口味？<span class="error-message" id="q6_error"></span></h3>
                <div class="options-container">
                    <input type="radio" name="entry.1881555323_sentinel" value="生日慶祝" id="q6_birthday" required><label for="q6_birthday">生日慶祝</label>
                    <input type="radio" name="entry.1881555323_sentinel" value="朋友聚會" id="q6_party"><label for="q6_party">朋友聚會</label>
                    <input type="radio" name="entry.1881555323_sentinel" value="特殊節日" id="q6_holiday"><label for="q6_holiday">特殊節日<small>（如聖誕節、情人節等）</small></label>
                    <input type="radio" name="entry.1881555323_sentinel" value="平常自己想吃就吃" id="q6_casual"><label for="q6_casual">平常自己想吃就吃</label>
                    <input type="radio" name="entry.1881555323_sentinel" value="幾乎不會選擇非傳統口味" id="q6_rarely"><label for="q6_rarely">幾乎不會選擇非傳統口味</label>
                </div>
            </div>

            <button type="submit">提交問卷</button>
        </form>

        <div id="results" style="display:none;">
            <h3>感謝您的填寫！以下是您的回覆：</h3>
            <pre id="formDataJson"></pre>
        </div>
    </div>

    <script>
        // JavaScript 邏輯開始
        const form = document.getElementById('cakeSurveyForm');
        const resultsDiv = document.getElementById('results');
        const formDataJsonPre = document.getElementById('formDataJson');

        // 輔助函數：獲取單選按鈕的值
        function getRadioValue(name) {
            const radioGroup = form.elements[name];
            if (radioGroup) { // RadioNodeList
                for (let i = 0; i < radioGroup.length; i++) {
                    if (radioGroup[i].checked) {
                        return radioGroup[i].value;
                    }
                }
            }
            return null; // 如果沒有選擇，返回 null
        }

        // 輔助函數：驗證單選按鈕組
        function validateRadioGroup(name, errorElementId) {
            const radioGroup = form.elements[name]; // 這會返回 RadioNodeList
            const errorElement = document.getElementById(errorElementId);
            let isSelected = false;

            if (radioGroup && typeof radioGroup.length !== 'undefined') { // 確保是 RadioNodeList
                for (let i = 0; i < radioGroup.length; i++) {
                    if (radioGroup[i].checked) {
                        isSelected = true;
                        break;
                    }
                }
            } else if (radioGroup && radioGroup.checked) { // 單個 radio 的情況 (雖然在此表單不適用)
                isSelected = true;
            } else if (!radioGroup) { // 元素未找到
                console.error(`Radio group with name "${name}" not found for validation.`);
                if (errorElement) errorElement.textContent = '表單配置錯誤，請聯繫管理員。';
                return false; // 嚴重錯誤，阻止提交
            }


            if (!isSelected) {
                if (errorElement) errorElement.textContent = '此為必填問題，請選擇一個選項。';
                return false;
            }
            if (errorElement) errorElement.textContent = ''; // 清除錯誤訊息
            return true;
        }

        form.addEventListener('submit', function(event) {
            event.preventDefault(); // 防止表單的默認提交行為

            // 清除之前的錯誤訊息
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            resultsDiv.style.display = 'none'; // 隱藏舊的結果

            // 進行驗證
            let isValid = true;
            // 為了讓錯誤訊息更精準地顯示在問題標題後，我們將 errorElementId 傳遞給 validateRadioGroup
            isValid = validateRadioGroup('q1_bloodType', 'q1_error') && isValid;
            isValid = validateRadioGroup('q2_factor', 'q2_error') && isValid;
            isValid = validateRadioGroup('q3_preference', 'q3_error') && isValid;
            isValid = validateRadioGroup('q4_reaction', 'q4_error') && isValid;
            isValid = validateRadioGroup('q5_tryFlavor', 'q5_error') && isValid;
            isValid = validateRadioGroup('q6_occasion', 'q6_error') && isValid;

            if (!isValid) {
                // 嘗試將視窗滾動到第一個帶有錯誤的區塊
                const firstErrorElement = document.querySelector('.error-message:not(:empty)');
                if (firstErrorElement) {
                    const errorBlock = firstErrorElement.closest('.question-block');
                    if (errorBlock) {
                         errorBlock.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
                return; // 如果驗證失敗，則不繼續
            }

            // 收集表單數據
            const formData = {
                "問題1_血型": getRadioValue('q1_bloodType'),
                "問題2_看重因素": getRadioValue('q2_factor'),
                "問題3_偏好類型": getRadioValue('q3_preference'),
                "問題4_創新反應": getRadioValue('q4_reaction'),
                "問題5_想嘗試口味": getRadioValue('q5_tryFlavor'),
                "問題6_嘗試場合": getRadioValue('q6_occasion'),
                "提交時間": new Date().toLocaleString('zh-TW', { timeZone: 'Asia/Taipei' })
            };

            // 在控制台輸出數據 (方便開發者調試)
            console.log("表單數據:", formData);

            // 在頁面上顯示數據
            formDataJsonPre.textContent = JSON.stringify(formData, null, 2); // null, 2 用於美化 JSON 輸出
            resultsDiv.style.display = 'block'; // 顯示結果區塊
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });


            // 提示用戶
            // alert('感謝您的填寫！您的回覆已記錄在頁面下方，並已輸出到瀏覽器控制台。');

            // 可選：提交後重置表單 (如果需要，取消下一行的註釋)
            // form.reset();
            // resultsDiv.style.display = 'none'; // 如果重置，也隱藏結果顯示區塊
        });
        // JavaScript 邏輯結束
    </script>
</body>
</html>